# A geostatistical approach to estimate high resolution nocturnal bird migration densities from a weather radar network.
<href="https://orcid.org/0000-0002-8185-1020" target="_blank"><i class="ai ai-orcid"></i></a>Raphaël Nussbaumer<sup>1,2</sup> , Lionel Benoit<sup>2</sup> , Grégoire Mariethoz<sup>2</sup> , Felix Liechti<sup>1</sup> , Silke
Bauer<sup>1</sup> and Baptiste Schmid<sup>1</sup>
- <sup>1</sup>Swiss Ornithological Institute, Sempach, Switzerland
- <sup>1</sup>Institute of Earth Surface Dynamics, University of Lausanne, Lausanne, Switzerland

bioRxiv [690065](https://www.biorxiv.org/content/10.1101/690065); doi: [10.1101/690065](https://doi.org/10.1101/690065)

## Abstract
1. Quantifying nocturnal bird migration at high resolution is essential for (1) understanding the phenology of migration and its drivers, (2) identifying critical spatio-temporal protection zones for migratory birds, and (3) assessing the risk of collision with man-made structures.
2. We propose a tailored geostatistical model to interpolate migration intensity monitored by a network of weather radars. The model is applied to data collected in autumn 2016 from 69 European weather radars. To validate the model, we performed a cross-validation and also compared our interpolation results with independent measurements of two bird radars.
3. Our model estimated bird densities at high resolution (0.2° latitude-longitude, 15min) and assessed the associated uncertainty. Within the area covered by the radar network, we estimated that around 120 million birds were simultaneously in flight (10-90 quantiles: 107-134). Local estimations can be easily visualized and retrieved from a dedicated interactive website: birdmigrationmap.vogelwarte.ch.
4. This proof-of-concept study demonstrates that a network of weather radar is able to quantify bird migration at high resolution and accuracy. The model presented has the ability to monitor population of migratory birds at scales ranging from regional to continental in space and daily to yearly in time. Near-real-time estimation should soon be possible with an update of the infrastructure and processing software.

## Dataset
Our dataset originates from measurements of 69 European weather radars covering a large part of the Western-European flyway during fall migration 2016.
The raw bird density data used in this study are found on the repository of [European Network for the Radar surveillance of Animal Movement (ENRAM)](http://enram.github.io/data-repository/) and were generated with [vol2bird](https://github.com/adokter/vol2bird).
These data were cleaned manually into vertical profile of reflectivity (see Appendix A in paper for details). These data are available on zenodo [![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.3243397.svg)](https://doi.org/10.5281/zenodo.3243397)

<img src="https://raw.githubusercontent.com/Rafnuss-PostDoc/BMM/master/2016/10-paper/figure/Figure2.png">
Illustration of the spatio-temporal variability of bird densities measured by a weather radar network. (a) Average bird densities measured by each radar over the whole study period. (b-d) Time series of bird densities measured by the radar with the corresponding outer ring colour in panel a. (e-g) Zoom on a two-days period.
A strong continental trend appears in (a) as well as a correlation at the multi-night scale when comparing (b), (c) and (d). These spatial correlations are even stronger at the regional scale when comparing within a subplot (e.g. (f)).The intra-night scale shows an obvious bell-shape curve pattern during each night (e.g. (g)).


## Model description

The strong spatio-temporal correlations  of bird migration motivated the use of a Gaussian process regression to interpolate bird densities measured by weather radars at high temporal resolution. Because of the multi-scale temporal structure of bird migration, we consider here an additive model combining two temporal scales: first, a multi-night process that models bird density averaged over the night, and second, an intra-nightly process that models variations within each night. Subsequently, each scale-specific process is further split into two terms: a smoothly-varying (in space and/or time) deterministic trend, and a stationary Gaussian process.

The bird density $$B(\mathbf{s},t)$$ observed at location $$\mathbf{s}$$ and at time $$t$$ is modelled by

$$B( \mathbf{s} ,t)^p = \mu( \mathbf{s} ) + M(\mathbf{s},d(t)) + \iota (\mathbf{s},t) + I(\mathbf{s},t)$$

where $$\mu$$ and $$\iota$$ are deterministic trends (respectively at the multi-night and intra-night resolution), and $$M$$ and $$I$$ are random effects (respectively at the multi-night and intra-night resolution) ; $$d(t)$$ is a step function that maps the continuous time $$t$$ to the discrete day $$d$$ of the closest night. A power transformation $$p$$ is applied on bird densities to transform the highly skewed marginal distribution into a Gaussian distribution. 


<img src="https://raw.githubusercontent.com/Rafnuss-PostDoc/BMM/master/2016/10-paper/figure/Figure3.png">

| Spatial trend  | Multi-night | Curve trend  | Intra-night |
| ------------- | ------------- | ------------- | ------------- |
|  <img src="https://raw.githubusercontent.com/Rafnuss-PostDoc/BMM/master/2016/figure/trend.png"> | <img src="https://raw.githubusercontent.com/Rafnuss-PostDoc/BMM/master/2016/figure/Density_estimationMap_amplitude.gif">  | <img src="https://raw.githubusercontent.com/Rafnuss-PostDoc/BMM/master/2016/figure/curve.png">  | <img src="https://raw.githubusercontent.com/Rafnuss-PostDoc/BMM/master/2016/figure/Density_estimationMap_residu.gif">  |

### Inference
The inference of the parameters is provided in [MATLAB LiveScript](https://rafnuss-postdoc.github.io/BMM/MatlabLiveScript/Inference.html)

## Validation
Validation is performed by (1) Cross-validation for each radar by ignoring the data of this radar for all time and estimating the bird density at the same location and time and (2) comparaison to Birdscan radars.

[MATLAB LiveScript of cross-validation](https://rafnuss-postdoc.github.io/BMM/MatlabLiveScript/Cross_validation.html)

[MATLAB LiveScript of validation with bird radar](https://rafnuss-postdoc.github.io/BMM/MatlabLiveScript/Validation_birdRadar.html)

[MATLAB LiveScript of cross-validation with simple interpolation](https://rafnuss-postdoc.github.io/BMM/MatlabLiveScript/Compare_interpolation.html)

## Estimation and simulation
Estimation and simulation are possible by computing each componenent of the model separatly and reassemble them. The two Gaussian process (amplitude and residu) are estimated/simulated using Kriging. 

[MATLAB code of estimation](https://github.com/Rafnuss-PostDoc/BMM/blob/master/2016/4-Estimation/Estimation_map.m)

[MATLAB code of simulation](https://github.com/Rafnuss-PostDoc/BMM/blob/master/2016/5-Simulation/Simulation_map.m)




## Result
[Check the online visualization](https://bmm.raphaelnussbaumer.com/).

| 					| Density [bird/m<sup>2</sup>] | Flight |
| ------------- 	| ------------- 	 | ------------- |
|  Estimation Map 	|  <img src="2016/figure/Density_estimationMap_reassamble.gif">  | <img src="2016/figure/Flight_estimationMap.gif">  |
| Simulation Map    |  <img src="2016/figure/Density_simulationMap_reassemble.gif"> | <img src="2016/figure/Flight_simulationMap.gif"> |

The final interpolated spatio-temporal map can also be downloaded from zenodo [![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.3243397.svg)](https://doi.org/10.5281/zenodo.3243397).

[<img src="2016/figure/FigureS5-3.png">](https://bmm.raphaelnussbaumer.com/)


## Read more

I'll be updating [the projet on reasearchgate](https://www.researchgate.net/project/Bird-Migration-Modelling-BMM) with conference presentations and articles.

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">
